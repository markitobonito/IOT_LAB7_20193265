# ğŸ¯ RESUMEN VISUAL - LAB 7 COMPLETADO

## âœ… PREGUNTA 1: Firebase Authentication (5 pts)

### Clase AuthService.java
```
src/main/java/com/example/appplication/services/
                        â”œâ”€â”€ AuthService.java âœ¨ NUEVO
                        â”œâ”€â”€ CloudStorage.java âœ¨ NUEVO
                        â””â”€â”€ RetrofitService.java âœ¨ NUEVO
```

### MÃ©todos Implementados:
```
âœ… initializeAuth()
   â””â”€ Instancia FirebaseAuth y Firestore

âœ… signInWithEmail(email, password, callback)
   â””â”€ Login con correo/contraseÃ±a

âœ… resetPassword(email, callback)
   â””â”€ EnvÃ­a email para recuperar contraseÃ±a

âœ… signOut(callback)
   â””â”€ Cierra la sesiÃ³n del usuario

âœ… registerUser(email, password, name, dni, callback)
   â”œâ”€ Valida con MICROSERVICIO primero
   â”œâ”€ POST http://192.168.x.x:8080/registro
   â”œâ”€ Si OK: crea usuario en Firebase Auth
   â”œâ”€ Guarda datos en Firestore (nombre, DNI)
   â””â”€ Si FALLA: muestra error del microservicio
```

### Firestore Actualizado:
```json
users/
â”œâ”€â”€ {userId}/
â”‚   â”œâ”€â”€ email: "usuario@pucp.edu.pe"
â”‚   â”œâ”€â”€ name: "Juan PÃ©rez"
â”‚   â”œâ”€â”€ dni: "12345678"
â”‚   â”œâ”€â”€ createdAt: Timestamp
â”‚   â””â”€â”€ profileImageUrl: ""  // VacÃ­o inicialmente
```

---

## âœ… PREGUNTA 2: Firebase Storage (5 pts)

### Clase CloudStorage.java
```
âœ… uploadFile(Uri, fileName, callback)
   â””â”€ Sube imagen a /users/{userId}/{fileName}

âœ… getDownloadUrl(fileName, callback)
   â””â”€ Obtiene URL pÃºblica del archivo

âœ… fileExists(fileName, callback)
   â””â”€ Verifica si archivo existe

âœ… deleteFile(fileName, callback)
   â””â”€ Elimina archivo
```

### Actividad ProfileActivity.java
```
â”œâ”€ Mostrar datos del usuario
â”‚  â”œâ”€ Nombre
â”‚  â”œâ”€ Email
â”‚  â””â”€ DNI
â”œâ”€ ImageView con foto de perfil
â”œâ”€ BotÃ³n "Subir Imagen de Perfil"
â”œâ”€ Selector de galerÃ­a
â”œâ”€ Progress bar durante carga
â”œâ”€ Toast con URL de almacenamiento
â””â”€ VisualizaciÃ³n con Glide
```

### Cloud Storage Actualizado:
```
users/
â”œâ”€â”€ {userId1}/
â”‚   â””â”€â”€ profile_image.jpg
â””â”€â”€ {userId2}/
    â””â”€â”€ profile_image.jpg
```

### Firestore Actualizado:
```json
users/
â”œâ”€â”€ {userId}/
â”‚   â”œâ”€â”€ email: "usuario@pucp.edu.pe"
â”‚   â”œâ”€â”€ name: "Juan PÃ©rez"
â”‚   â”œâ”€â”€ dni: "12345678"
â”‚   â”œâ”€â”€ createdAt: Timestamp
â”‚   â””â”€â”€ profileImageUrl: "https://firebasestorage.googleapis.com/..."
```

---

## âœ… PREGUNTA 3: Ecosistema de Microservicios (10 pts)

### Arquitectura:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        Android App                    â”‚
â”‚  POST http://192.168.x.x:8080/       â”‚
â”‚  { "email": "...", "dni": "..." }    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    registro-service:8080              â”‚
â”‚  (Orchestrator)                       â”‚
â”‚  - Feign Client                       â”‚
â”‚  - Eureka Client                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                     â”‚
         â”‚                     â”‚ Feign Call
         â”‚                     â”‚
         â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚          â”‚ validacion-service  â”‚
         â”‚          â”‚ :8010               â”‚
         â”‚          â”‚ - DNI validation    â”‚
         â”‚          â”‚ - Email validation  â”‚
         â”‚          â”‚ - Eureka Client     â”‚
         â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Eureka Server :8761         â”‚
â”‚   (Service Registry)          â”‚
â”‚   - Descubre servicios        â”‚
â”‚   - Proporciona ubicaciones   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Proyecto 1: eureka-server

**Puerto:** 8761

**Dependencias:**
- spring-cloud-starter-netflix-eureka-server

**ConfiguraciÃ³n:**
```yaml
server:
  port: 8761
spring:
  application:
    name: eureka-server
eureka:
  client:
    register-with-eureka: false
    fetch-registry: false
```

**Clase principal:**
```java
@SpringBootApplication
@EnableEurekaServer
public class EurekaServerApplication
```

---

### Proyecto 2: validacion-service

**Puerto:** 8010

**Endpoints:**
```
GET /validar/dni/{dni}
    â””â”€ Valida que DNI tenga 8 dÃ­gitos
    â”œâ”€ 200: {"valido": true}
    â””â”€ 400: {"valido": false, "mensaje": "..."}

GET /validar/correo/{correo}
    â””â”€ Valida que email termine en @pucp.edu.pe
    â”œâ”€ 200: {"valido": true}
    â””â”€ 400: {"valido": false, "mensaje": "..."}
```

**Dependencias:**
- spring-cloud-starter-netflix-eureka-client

**ConfiguraciÃ³n:**
```yaml
server:
  port: 8010
spring:
  application:
    name: validacion-service
eureka:
  client:
    service-url:
      defaultZone: http://localhost:8761/eureka/
```

---

### Proyecto 3: registro-service

**Puerto:** 8080

**Endpoint:**
```
POST /registro
Body: {"email": "usuario@pucp.edu.pe", "dni": "12345678"}

LÃ³gica:
1. Recibe email y dni
2. Feign call a validacion-service GET /validar/dni/{dni}
3. Feign call a validacion-service GET /validar/correo/{email}
4. Si ambas OK â†’ HTTP 200 {"mensaje": "..."}
5. Si alguna FALLA â†’ HTTP 400 {"mensaje": "..."}
```

**Dependencias:**
- spring-cloud-starter-netflix-eureka-client
- spring-cloud-starter-openfeign

**ConfiguraciÃ³n:**
```yaml
server:
  port: 8080
spring:
  application:
    name: registro-service
eureka:
  client:
    service-url:
      defaultZone: http://localhost:8761/eureka/
```

---

## ğŸ“¦ DEPENDENCIAS AGREGADAS

```gradle
// Firebase Storage
implementation("com.google.firebase:firebase-storage")
implementation("com.firebaseui:firebase-ui-storage:8.0.2")

// Glide para imÃ¡genes
implementation("com.github.bumptech.glide:glide:4.15.1")
annotationProcessor("com.github.bumptech.glide:compiler:4.15.1")

// Retrofit + OkHttp + Gson para HTTP
implementation("com.squareup.retrofit2:retrofit:2.9.0")
implementation("com.squareup.retrofit2:converter-gson:2.9.0")
implementation("com.squareup.okhttp3:okhttp:4.9.3")
implementation("com.google.code.gson:gson:2.10.1")
```

---

## ğŸ“ ARCHIVOS NUEVOS CREADOS

### Java Classes:
```
âœ¨ AuthService.java
âœ¨ CloudStorage.java
âœ¨ RetrofitService.java
âœ¨ ProfileActivity.java
âœ¨ MyAppGlideModule.java
```

### Layouts:
```
âœ¨ activity_profile.xml
âœ¨ fragment_login.xml
âœ¨ fragment_register.xml
```

### DocumentaciÃ³n:
```
âœ¨ README.md                          (Este archivo)
âœ¨ INSTRUCCIONES_FINALES.md           (5 minutos para configurar)
âœ¨ RESUMEN_IMPLEMENTACION.md          (Detalle de cambios)
âœ¨ MICROSERVICIOS_CONFIGURACION.md    (CÃ³digo completo P3)
âœ¨ VISUAL_RESUMEN.txt                 (Este documento)
```

### Modificados:
```
âœï¸ build.gradle.kts                  (Nuevas dependencias)
âœï¸ AndroidManifest.xml               (ProfileActivity)
âœï¸ MainActivity.java                 (BotÃ³n Mi Perfil)
```

---

## ğŸš€ FLUJO DE EJECUCIÃ“N

### Paso 1: ConfiguraciÃ³n (5 min)
```bash
1. Actualizar IP en RetrofitService.java
   private static final String BASE_URL = "http://192.168.x.x:8080/";

2. Sync Gradle en Android Studio
   File â†’ Sync Now

3. Verificar google-services.json estÃ¡ en app/
```

### Paso 2: Ejecutar Microservicios
```bash
Terminal 1:
  cd eureka-server
  mvn spring-boot:run
  
Terminal 2:
  cd validacion-service
  mvn spring-boot:run
  
Terminal 3:
  cd registro-service
  mvn spring-boot:run
```

### Paso 3: Ejecutar App Android
```bash
Android Studio:
  Run â†’ Select Device â†’ Run App
```

### Paso 4: Pruebas
```bash
1. Intenta registrarte con:
   - DNI: 12345678 (8 dÃ­gitos)
   - Email: tu_usuario@pucp.edu.pe
   - ContraseÃ±a: 123456
   
2. Si OK â†’ Usuario creado en Firebase
3. Abre "Mi Perfil"
4. Sube una imagen
5. Verifica URL en toast y Firestore
```

---

## ğŸ“Š VERIFICACIÃ“N

### En Firebase Console (https://console.firebase.google.com/)

**Authentication:**
```
âœ“ Usuarios registrados
âœ“ Email
âœ“ UID
```

**Firestore - ColecciÃ³n "users":**
```json
{
  "email": "usuario@pucp.edu.pe",
  "name": "Nombre",
  "dni": "12345678",
  "createdAt": Timestamp,
  "profileImageUrl": "https://..."
}
```

**Cloud Storage - Carpeta "users":**
```
users/
â”œâ”€â”€ userId1/
â”‚   â””â”€â”€ profile_image.jpg
â””â”€â”€ userId2/
    â””â”€â”€ profile_image.jpg
```

### En Terminal (Microservicios)

**Eureka Dashboard:**
```
http://localhost:8761/
```

DeberÃ­a mostrar:
```
âœ“ validacion-service (8010)
âœ“ registro-service (8080)
```

---

## âœ… CHECKLIST FINAL

### Android App:
- [ ] AuthService.java compila
- [ ] CloudStorage.java compila
- [ ] ProfileActivity.java compila
- [ ] RetrofitService.java con IP correcta
- [ ] build.gradle.kts con dependencias
- [ ] AndroidManifest.xml con ProfileActivity
- [ ] MyAppGlideModule.java presente
- [ ] App compila sin errores
- [ ] Firebase conectado correctamente

### Microservicios:
- [ ] eureka-server corre en 8761
- [ ] validacion-service corre en 8010
- [ ] registro-service corre en 8080
- [ ] Todos registrados en Eureka
- [ ] Endpoints responden correctamente

### Funcionalidad:
- [ ] Login funciona
- [ ] RecuperaciÃ³n de contraseÃ±a funciona
- [ ] Registro valida con microservicio
- [ ] Perfil carga datos correctamente
- [ ] Subida de imagen funciona
- [ ] Imagen se visualiza con Glide
- [ ] URL aparece en toast
- [ ] Datos guardados en Firestore

### DocumentaciÃ³n:
- [ ] README.md actualizado
- [ ] INSTRUCCIONES_FINALES.md leÃ­do
- [ ] RESUMEN_IMPLEMENTACION.md leÃ­do
- [ ] MICROSERVICIOS_CONFIGURACION.md leÃ­do

### Entrega:
- [ ] Video grabado (mÃ¡x 3 min)
- [ ] CÃ³digo en GitHub
- [ ] URL en Paideia
- [ ] Commit antes de deadline

---

## ğŸ¬ ESTRUCTURA DE VIDEO (MÃ¡x 3 minutos)

```
00:00-00:15  Firebase Console
             â”œâ”€ Authentication (usuarios)
             â”œâ”€ Firestore (datos)
             â””â”€ Cloud Storage (imÃ¡genes)

00:15-00:45  Microservicios
             â”œâ”€ 3 terminales corriendo
             â””â”€ Eureka dashboard

00:45-02:30  Demo App
             â”œâ”€ Registro exitoso
             â”œâ”€ Login
             â”œâ”€ Abrir Perfil
             â”œâ”€ Subir imagen
             â””â”€ Ver URL

02:30-03:00  VerificaciÃ³n
             â”œâ”€ Datos en Firebase
             â””â”€ Logs de app
```

---

## ğŸ‰ Â¡LISTO PARA COMENZAR!

**Todos los archivos estÃ¡n listos.**
**Todo el cÃ³digo estÃ¡ incluido.**
**Solo falta configurar la IP y crear los 3 proyectos Spring Boot.**

### PrÃ³ximos pasos:
1. Lee `INSTRUCCIONES_FINALES.md`
2. Actualiza IP en RetrofitService.java
3. Crea los 3 proyectos Spring Boot
4. Ejecuta y prueba
5. Graba video
6. Sube a GitHub

**Â¡Buena suerte! ğŸš€**
